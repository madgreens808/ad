# Block basic UNION SELECT SQLi attempts in input and POST body (tune as needed)
SecRule REQUEST_METHOD "@rx ^(GET|POST)$" "id:950100,phase:2,pass,log,ctl:ruleEngine=DetectionOnly,msg:'vulnapp SQLi candidate',chain"
  SecRule ARGS|ARGS_NAMES|REQUEST_BODY "@rx (?i)union\s+select" "t:none"

# Block simple XSS script tags in reflected parameters
SecRule ARGS|ARGS_NAMES "@rx <script" "id:950101,phase:2,pass,log,msg:'vulnapp reflected XSS candidate'"

# Block obvious scanner user agents
SecRule REQUEST_HEADERS:User-Agent "@pm sqlmap nikto w3af" "id:950102,phase:1,pass,log,msg:'scanner UA detected'"

# Example: Deny when both UNION SELECT and script appear (aggressive)
SecRule ARGS|REQUEST_BODY "@rx (?i)union\s+select" "id:950200,phase:2,deny,log,msg:'vulnapp confirmed SQLi block'"
